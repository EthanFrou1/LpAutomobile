@page "/Vehicules/Details/{id:int}"
@model LpAutomobile.Pages.Catalogue.DetailsModel
@{
    var v = Model.Vehicule;
    ViewData["Title"] = $"{v.Marque} {v.Modele} - LP Automobile";
}

<!-- Hero Section avec breadcrumb -->
<div class="vehicule-hero-section">
    <div class="container nav-detail">
        <!-- Breadcrumb moderne -->
        <nav class="breadcrumb-nav" aria-label="breadcrumb">
            <ol class="breadcrumb-list">
                <li><a href="/" class="breadcrumb-link link-blue">Accueil</a></li>
                <li><a href="/Vehicules/Catalogue" class="breadcrumb-link link-blue">Catalogue</a></li>
                <li class="breadcrumb-current">@v.Marque @v.Modele</li>
            </ol>
        </nav>

        <!-- Badge de retour -->
        <a href="/Vehicules/Catalogue" class="back-button">
            <i class="bi bi-arrow-left"></i>
            Retour au catalogue
        </a>
    </div>
</div>

<!-- Section principale véhicule -->
<div class="vehicule-detail-container">
    <div class="container">
        <div class="vehicule-detail-grid">
            
            <!-- Colonne gauche : Photos -->
            <div class="vehicule-photos-section">
                <!-- Galerie principale -->
                @if (v.Photos != null && v.Photos.Count > 0)
                {
                    <div class="main-gallery">
                        <div id="vehiculePhotosCarousel" class="photo-carousel" data-bs-ride="carousel">
                            <div class="carousel-inner">
                                @for (int i = 0; i < v.Photos.Count; i++)
                                {
                                    <div class="carousel-item @(i == 0 ? "active" : "")">
                                        <img src="@v.Photos[i].Url" 
                                             alt="@v.Marque @v.Modele - Photo @(i + 1)"
                                             class="main-photo" 
                                             onclick="openPhotoModal(@i)">
                                        
                                        <!-- Badge compteur photos -->
                                        <div class="photo-counter">
                                            <i class="bi bi-camera"></i>
                                            @(i + 1) / @v.Photos.Count
                                        </div>
                                    </div>
                                }
                            </div>

                            @if (v.Photos.Count > 1)
                            {
                                <button class="carousel-control carousel-control-prev btn" type="button" data-bs-target="#vehiculePhotosCarousel" data-bs-slide="prev">
                                    <i class="bi bi-chevron-left"></i>
                                </button>
                                <button class="carousel-control carousel-control-next btn" type="button" data-bs-target="#vehiculePhotosCarousel" data-bs-slide="next">
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            }
                        </div>

                        <!-- Miniatures -->
                        @if (v.Photos.Count > 1)
                        {
                            <div class="photo-thumbnails">
                                @for (int i = 0; i < Math.Min(v.Photos.Count, 6); i++)
                                {
                                    <div class="thumbnail @(i == 0 ? "active" : "")" 
                                         data-bs-target="#vehiculePhotosCarousel" 
                                         data-bs-slide-to="@i">
                                        <img src="@v.Photos[i].Url" alt="Miniature @(i + 1)">
                                        @if (i == 5 && v.Photos.Count > 6)
                                        {
                                            <div class="thumbnail-overlay">
                                                +@(v.Photos.Count - 5)
                                            </div>
                                        }
                                    </div>
                                }
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="no-photo-placeholder">
                        <i class="bi bi-image"></i>
                        <p>Aucune photo disponible</p>
                    </div>
                }
            </div>

            <!-- Colonne droite : Informations et actions -->
            <div class="vehicule-info-section">
                
                <!-- Header véhicule -->
                <div class="vehicule-header-details">
                    <div class="vehicule-badges-details">
                        @if (v.Annee >= DateTime.Now.Year - 2)
                        {
                            <span class="badge badge-recent">Récent</span>
                        }
                        @if (v.Prix < 15000)
                        {
                            <span class="badge badge-good-price">Bon prix</span>
                        }
                        <span class="badge badge-guaranteed">Garanti</span>
                    </div>
                    
                    <h1 class="vehicule-title">@v.Marque @v.Modele</h1>
                    <p class="vehicule-subtitle">@v.Description</p>
                </div>

                <!-- Prix principal -->
                <div class="price-section">
                    <div class="main-price">
                        <span class="price-amount">@v.Prix.ToString("C0")</span>
                        <span class="price-label">Prix de vente</span>
                    </div>
                    <div class="monthly-price">
                        <span class="monthly-amount">@v.PrixMensuel.ToString("C0")</span>
                        <span class="monthly-label">/ mois sur 60 mois*</span>
                    </div>
                </div>

                <!-- Boutons d'action principaux -->
                <div class="action-buttons">
                    <button class="btn btn-primary btn-large btn-contact" onclick="openContactModal('interest')">
                        <i class="bi bi-chat-dots"></i>
                        Je suis intéressé(e)
                    </button>
                    <button class="btn btn-outline-primary btn-large btn-offer" onclick="openContactModal('offer')">
                        <i class="bi bi-tag"></i>
                        Faire une offre
                    </button>
                    <button class="btn btn-outline-secondary btn-reservation" onclick="openContactModal('reservation')">
                        <i class="bi bi-calendar-check"></i>
                        Réserver un essai
                    </button>
                </div>

                <!-- Caractéristiques principales -->
                <div class="vehicule-specs-details">
                    <h3>Caractéristiques</h3>
                    <div class="specs-grid">
                        <div class="spec-item">
                            <div class="spec-icon">
                                <i class="bi bi-calendar3"></i>
                            </div>
                            <div class="spec-content">
                                <span class="spec-label">Année</span>
                                <span class="spec-value">@v.Annee</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon">
                                <i class="bi bi-speedometer2"></i>
                            </div>
                            <div class="spec-content">
                                <span class="spec-label">Kilométrage</span>
                                <span class="spec-value">@v.Kilometrage.ToString("N0") km</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon">
                                <i class="bi bi-lightning"></i>
                            </div>
                            <div class="spec-content">
                                <span class="spec-label">Énergie</span>
                                <span class="spec-value">@v.Energie</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon">
                                <i class="bi bi-gear"></i>
                            </div>
                            <div class="spec-content">
                                <span class="spec-label">Transmission</span>
                                <span class="spec-value">@v.Transmission</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="spec-icon">
                                <i class="bi bi-palette"></i>
                            </div>
                            <div class="spec-content">
                                <span class="spec-label">Couleur</span>
                                <span class="spec-value">@v.Couleur</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Équipements -->
                @if (v.Equipements?.Count > 0)
                {
                    <div class="vehicule-equipment">
                        <h3>Équipements inclus</h3>
                        <div class="equipment-list">
                            @foreach (var equipement in v.Equipements.Take(6))
                            {
                                <div class="equipment-item">
                                    <i class="bi bi-check-circle"></i>
                                    <span>@equipement.Nom</span>
                                </div>
                            }
                            @if (v.Equipements.Count > 6)
                            {
                                <button class="show-more-equipment" onclick="showAllEquipment()">
                                    + Voir tous les équipements (@v.Equipements.Count)
                                </button>
                            }
                        </div>
                    </div>
                }

                <!-- Garanties et services -->
                <div class="guarantees-section">
                    <h3>Nos garanties</h3>
                    <div class="guarantee-items">
                        <div class="guarantee-item">
                            <i class="bi bi-shield-check"></i>
                            <span>Véhicule contrôlé</span>
                        </div>
                        <div class="guarantee-item">
                            <i class="bi bi-tools"></i>
                            <span>Garantie mécanique</span>
                        </div>
                        <div class="guarantee-item">
                            <i class="bi bi-arrow-repeat"></i>
                            <span>Reprise possible</span>
                        </div>
                        <div class="guarantee-item">
                            <i class="bi bi-credit-card"></i>
                            <span>Financement disponible</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Modal photos -->
<div id="photoModal" class="photo-modal">
    <div class="photo-modal-content">
        <div class="photo-modal-body">
            <div class="photo-modal-nav">
                <button class="photo-nav-btn btn" id="prevPhotoBtn" onclick="prevModalPhoto()">
                    <i class="bi bi-chevron-left"></i>
                </button>
            </div>
            <img id="modalPhoto" src="" alt="">
            <div class="photo-modal-counter">
                <span id="modalPhotoCounter">1 / @(v.Photos?.Count ?? 0)</span>
            </div>
             <div class="photo-modal-nav">
                <button class="photo-nav-btn btn" id="nextPhotoBtn" onclick="nextModalPhoto()">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div>
        </div>
        <button class="photo-modal-close" onclick="closePhotoModal()">
            <i class="bi bi-x"></i>
        </button>
    </div>
</div>

<!-- Réseaux sociaux & contacts -->
<section class="bg-light py-4 text-white text-primary">
    <div class="container">
        <div class="row text-center align-items-center">
            <div class="col-6 col-md">
                <a href="https://www.facebook.com/Lpautomobile66/?locale=fr_FR" target="_blank" class="text-white text-decoration-none link-contact">
                    <i class="bi bi-facebook fs-2 mb-2 d-block text-primary"></i>
                    <span class="small text-primary">Facebook</span>
                </a>
            </div>
            <div class="col-6 col-md">
                <a href="https://occasion.largus.fr/auto/lp-automobile_152969/" target="_blank" class="text-white text-decoration-none link-contact">
                    <img src="/img/logo-argus.png" alt="L'Argus" class="img-argus mb-2"/>
                    <span class="small d-block"></span>
                </a>
            </div>
            <div class="col-6 col-md">
                <a href="https://wa.me/33633169477" target="_blank" class="text-white text-decoration-none link-contact">
                    <i class="bi bi-whatsapp fs-2 mb-2 d-block text-primary"></i>
                    <span class="small text-primary">WhatsApp</span>
                </a>
            </div>
            <div class="col-6 col-md">
                <a href="tel:+33633169477" class="text-white text-decoration-none link-contact">
                    <i class="bi bi-telephone-fill fs-2 mb-2 d-block text-primary"></i>
                    <span class="small text-primary">06 33 16 94 77</span>
                </a>
            </div>
            <div class="col-6 col-md">
                <a href="mailto:ethanfrou1@gmail.com" class="text-white text-decoration-none link-contact">
                    <i class="bi bi-envelope-fill fs-2 mb-2 d-block text-primary"></i>
                    <span class="small text-primary">Email</span>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Avis Google - garde ton code existant mais améliore le titre -->
@if (Model.Avis != null && Model.Avis.Any())
{
    <section class="py-5" data-aos="fade-up" data-aos-duration="1000">
        <div class="container text-center">
            <h2 class="section-title display-5 fw-bold mb-3">Ils nous font confiance</h2>
            <div class="mb-5 mt-5">
                <div class="d-inline-flex align-items-center px-4 py-2 rounded-pill shadow-sm btn pointer-none">
                    <span class="fw-bold fs-4 text-warning">4.8</span>
                    <div class="text-warning">
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                        <i class="bi bi-star-fill"></i>
                    </div>
                    <span class="">• 50+ avis Google</span>
                </div>
            </div>
            @await Html.PartialAsync("_AvisGooglePartial", Model.Avis)
            <div class="mt-4 bloc-btn-avis-google" data-aos="zoom-in" data-aos-duration="1000">
                <a href="https://www.google.com/maps/place/Lp+Automobiles/" target="_blank" class="btn btn-outline-primary btn-lg pointer-none;">
                    <i class="bi bi-google me-2"></i>
                    Voir tous les avis Google
                </a>
            </div>
        </div>
    </section>
}

<!-- Carte - garde ton code existant -->
<section class="py-5 bg-light" data-aos="fade-up" data-aos-duration="1000">
    <div class="container">
        <h2 class="section-title text-center display-5 fw-bold mb-5">Nous localiser</h2>
        <div class="row">
            <div class="map">
                <div class="map-container rounded shadow">
                    <iframe src="https://www.google.com/maps?q=14+Rue+Louis+Piquemal,+66240+Saint-Esteve&output=embed"
                            width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy" class="rounded">
                    </iframe>
                </div>


                <!-- Bouton Itinéraire -->
                <div class="text-center block-btn-map">
                    <button id="btnItineraire" class="btn btn-primary btn-lg px-5 py-3" data-aos="zoom-in" data-aos-delay="200">
                        <i class="bi bi-geo-alt-fill me-2"></i>
                        Venir chez nous
                        <i class="bi bi-arrow-right ms-2"></i>
                    </button>
                    <p class="text-muted mt-2 small">
                        <i class="bi bi-info-circle me-1"></i>
                        Ouvre Google Maps avec l'itinéraire depuis votre position
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- BOUTON SCROLL TO TOP -->
<button id="scrollToTop" class="scroll-to-top-btn" title="Retour en haut">
    <i class="bi bi-chevron-up"></i>
</button>

<!-- Messages de feedback -->
@if (!string.IsNullOrEmpty(Model.ContactSuccess))
{
    <div class="alert alert-success alert-dismissible fade show position-fixed" 
         style="top: 20px; right: 20px; z-index: 1060; max-width: 400px;">
        <i class="bi bi-check-circle me-2"></i>
        @Model.ContactSuccess
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (!string.IsNullOrEmpty(Model.ContactError))
{
    <div class="alert alert-danger alert-dismissible fade show position-fixed" 
         style="top: 20px; right: 20px; z-index: 1060; max-width: 400px;">
        <i class="bi bi-exclamation-triangle me-2"></i>
        @Model.ContactError
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<!-- =================================
     MODAL 1: JE SUIS INTÉRESSÉ(E)
     ================================= -->
<div class="modal fade d-none" id="interestModal" tabindex="-1">
    <div class="modal-lg">
        <div class="modal-content contact-modal-content">
            <div class="modal-header contact-modal-header interest-modal-header">
                <h5 class="modal-title contact-modal-title">
                    <i class="bi bi-chat-dots"></i>
                    Demande d'informations
                </h5>
                <button type="button" class="btn-close contact-modal-close contact-modal-close-white" data-bs-dismiss="modal"></button>
            </div>

            <form method="post" asp-page-handler="Interesse">
                <input type="hidden" name="vehiculeId" value="@Model.Vehicule.Id" />

                <div class="modal-body contact-modal-body">
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="alert contact-alert contact-alert-info">
                                <strong>@Model.Vehicule.Marque @Model.Vehicule.Modele</strong> - @Model.Vehicule.Prix.ToString("C0")
                            </div>
                        </div>
                    </div>

                    <div class="row g-3 contact-form-row">
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Nom complet *</label>
                            <input type="text" name="nom" class="form-control contact-form-input" required
                                   placeholder="Votre nom et prénom">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Email *</label>
                            <input type="email" name="email" class="form-control contact-form-input" required
                                   placeholder="votre@email.com">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Téléphone *</label>
                            <input type="tel" name="telephone" class="form-control contact-form-input" required
                                   placeholder="06 12 34 56 78">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Votre demande *</label>
                            <select name="motivation" class="form-select contact-form-select" required>
                                <option value="">Sélectionnez...</option>
                                <option value="Plus d'informations générales">Plus d'informations générales</option>
                                <option value="Historique du véhicule">Historique du véhicule</option>
                                <option value="Questions sur la garantie">Questions sur la garantie</option>
                                <option value="Informations financement">Informations financement</option>
                                <option value="Disponibilité véhicule">Disponibilité véhicule</option>
                                <option value="Autre demande">Autre demande</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <label class="form-label contact-form-label">Message (optionnel)</label>
                            <textarea name="message" class="form-control contact-form-textarea" rows="3"
                                      placeholder="Questions particulières ou détails de votre demande..."></textarea>
                        </div>
                        <div class="col-12">
                            <div class="border p-3 rounded bg-light contact-info-section">
                                <h6 class="mb-2">Préférences de contact :</h6>
                                <div class="form-check contact-form-check">
                                    <input type="checkbox" name="recevoir_email" class="form-check-input contact-form-check-input"
                                           id="recevoir_email" checked>
                                    <label class="form-check-label contact-form-check-label" for="recevoir_email">
                                        Recevoir les informations par email
                                    </label>
                                </div>
                                <div class="form-check contact-form-check">
                                    <input type="checkbox" name="recevoir_appel" class="form-check-input contact-form-check-input"
                                           id="recevoir_appel">
                                    <label class="form-check-label contact-form-check-label" for="recevoir_appel">
                                        Être rappelé par téléphone
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer contact-modal-footer">
                    <button type="button" class="btn btn-outline-secondary contact-btn contact-btn-cancel" data-bs-dismiss="modal">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-primary contact-btn contact-btn-primary">
                        <i class="bi bi-send"></i>
                        Envoyer ma demande
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- =================================
     MODAL 2: FAIRE UNE OFFRE
     ================================= -->
<div class="modal fade d-none" id="offerModal" tabindex="-1">
    <div class="modal-lg">
        <div class="modal-content contact-modal-content">
            <div class="modal-header contact-modal-header offer-modal-header">
                <h5 class="modal-title contact-modal-title">
                    <i class="bi bi-tag"></i>
                    Proposer une offre
                </h5>
                <button type="button" class="btn-close contact-modal-close" data-bs-dismiss="modal"></button>
            </div>

            <form method="post" asp-page-handler="Offre" id="offerForm">
                <input type="hidden" name="vehiculeId" value="@Model.Vehicule.Id" />

                <div class="modal-body contact-modal-body">
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="alert contact-alert contact-alert-warning">
                                <strong>@Model.Vehicule.Marque @Model.Vehicule.Modele</strong>
                                - Prix affiché : <strong>@Model.Vehicule.Prix.ToString("C0")</strong>
                            </div>
                        </div>
                    </div>

                    <div class="row g-3 contact-form-row">
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Nom complet *</label>
                            <input type="text" name="nom" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Email *</label>
                            <input type="email" name="email" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Téléphone *</label>
                            <input type="tel" name="telephone" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Votre offre (€) *</label>
                            <input type="number" name="montant_offre" class="form-control contact-form-input" required
                                   min="1000" max="@((int)Model.Vehicule.Prix - 500)"
                                   placeholder="Ex: @((int)Model.Vehicule.Prix - 2000)">
                            <small class="text-muted contact-text-muted">Montant entre 1 000€ et @((int)Model.Vehicule.Prix - 500)€</small>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Mode de paiement *</label>
                            <select name="mode_paiement" class="form-select contact-form-select" required id="modePaiement">
                                <option value="">Sélectionnez...</option>
                                <option value="Paiement comptant">Paiement comptant</option>
                                <option value="Financement (étude nécessaire)">Financement (étude nécessaire)</option>
                                <option value="Reprise + complément">Reprise + complément</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Délai d'achat *</label>
                            <select name="delai_achat" class="form-select contact-form-select" required>
                                <option value="">Sélectionnez...</option>
                                <option value="Dans la semaine">Dans la semaine</option>
                                <option value="Dans le mois">Dans le mois</option>
                                <option value="Dans les 3 mois">Dans les 3 mois</option>
                                <option value="Plus de 3 mois">Plus de 3 mois</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section reprise (conditionnelle) -->
                    <div id="repriseSection" style="display: none;" class="mt-4">
                        <div class="border p-3 rounded bg-light contact-reprise-section">
                            <h6 class="mb-3">Véhicule à reprendre :</h6>
                            <div class="row g-3 contact-form-row">
                                <div class="col-md-6">
                                    <input type="text" name="reprise_marque" class="form-control contact-form-input"
                                           placeholder="Marque et modèle">
                                </div>
                                <div class="col-md-3">
                                    <input type="number" name="reprise_annee" class="form-control contact-form-input"
                                           min="1990" max="2025" placeholder="Année">
                                </div>
                                <div class="col-md-3">
                                    <input type="number" name="reprise_km" class="form-control contact-form-input"
                                           min="0" placeholder="Kilométrage">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 mt-3">
                        <label class="form-label contact-form-label">Commentaires sur votre offre</label>
                        <textarea name="commentaires" class="form-control contact-form-textarea" rows="3"
                                  placeholder="Précisions, justifications de votre offre..."></textarea>
                    </div>
                </div>

                <div class="modal-footer contact-modal-footer">
                    <button type="button" class="btn btn-outline-secondary contact-btn contact-btn-cancel" data-bs-dismiss="modal">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-warning contact-btn contact-btn-warning">
                        <i class="bi bi-tag"></i>
                        Envoyer mon offre
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- =================================
     MODAL 3: RÉSERVER UN ESSAI
     ================================= -->
<div class="modal fade d-none" id="testDriveModal" tabindex="-1">
    <div class="modal-lg">
        <div class="modal-content contact-modal-content">
            <div class="modal-header contact-modal-header test-drive-modal-header">
                <h5 class="modal-title contact-modal-title">
                    <i class="bi bi-calendar-check"></i>
                    Réserver un essai
                </h5>
                <button type="button" class="btn-close contact-modal-close contact-modal-close-white" data-bs-dismiss="modal"></button>
            </div>

            <form method="post" asp-page-handler="Essai" id="testDriveForm">
                <input type="hidden" name="vehiculeId" value="@Model.Vehicule.Id" />

                <div class="modal-body contact-modal-body">
                    <div class="row mb-3">
                        <div class="col-12">
                            <div class="alert contact-alert contact-alert-success">
                                <strong>@Model.Vehicule.Marque @Model.Vehicule.Modele</strong>
                                - Essai gratuit et sans engagement
                            </div>
                        </div>
                    </div>

                    <div class="row g-3 contact-form-row">
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Nom complet *</label>
                            <input type="text" name="nom" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Email *</label>
                            <input type="email" name="email" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Téléphone *</label>
                            <input type="tel" name="telephone" class="form-control contact-form-input" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Date souhaitée *</label>
                            <input type="date" name="date_souhaitee" class="form-control contact-form-input" required
                                   min="@DateTime.Now.AddDays(1):yyyy-MM-dd"
                                   max="@DateTime.Now.AddMonths(2):yyyy-MM-dd">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Créneau horaire *</label>
                            <select name="creneau" class="form-select contact-form-select" required>
                                <option value="">Sélectionnez...</option>
                                <option value="09h00 - 10h00">09h00 - 10h00</option>
                                <option value="10h00 - 11h00">10h00 - 11h00</option>
                                <option value="11h00 - 12h00">11h00 - 12h00</option>
                                <option value="14h00 - 15h00">14h00 - 15h00</option>
                                <option value="15h00 - 16h00">15h00 - 16h00</option>
                                <option value="16h00 - 17h00">16h00 - 17h00</option>
                                <option value="17h00 - 18h00">17h00 - 18h00</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label contact-form-label">Durée souhaitée</label>
                            <select name="duree" class="form-select contact-form-select">
                                <option value="30">30 minutes</option>
                                <option value="60" selected>1 heure</option>
                                <option value="120">2 heures</option>
                            </select>
                        </div>
                    </div>

                    <div class="row g-3 mt-3 contact-form-row">
                        <div class="col-12">
                            <div class="border p-3 rounded bg-light contact-info-section">
                                <h6 class="mb-3">Informations permis de conduire :</h6>
                                <div class="row g-3 contact-form-row">
                                    <div class="col-md-6">
                                        <label class="form-label contact-form-label">Numéro de permis *</label>
                                        <input type="text" name="numero_permis" class="form-control contact-form-input" required
                                               placeholder="Ex: 123456789012">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label contact-form-label">Ancienneté du permis *</label>
                                        <select name="anciennete_permis" class="form-select contact-form-select" required>
                                            <option value="">Sélectionnez...</option>
                                            <option value="Moins d'1 an">Moins d'1 an</option>
                                            <option value="1 à 3 ans">1 à 3 ans</option>
                                            <option value="Plus de 3 ans">Plus de 3 ans</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-12">
                            <div class="form-check contact-form-check">
                                <input type="checkbox" name="avec_conseiller" class="form-check-input contact-form-check-input"
                                       id="avec_conseiller">
                                <label class="form-check-label contact-form-check-label" for="avec_conseiller">
                                    Je souhaite être accompagné d'un conseiller commercial
                                </label>
                            </div>
                        </div>

                        <div class="col-12">
                            <label class="form-label contact-form-label">Demandes spéciales</label>
                            <textarea name="demandes_speciales" class="form-control contact-form-textarea" rows="3"
                                      placeholder="Parcours souhaité, questions spécifiques..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="modal-footer contact-modal-footer">
                    <button type="button" class="btn btn-outline-secondary contact-btn contact-btn-cancel" data-bs-dismiss="modal">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-success contact-btn contact-btn-success">
                        <i class="bi bi-calendar-check"></i>
                        Réserver l'essai
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Variables pour JavaScript -->
<script>
    window.vehiculeData = {
        id: @Model.Vehicule.Id,
        prix: @Model.Vehicule.Prix,
        marque: '@Model.Vehicule.Marque',
        modele: '@Model.Vehicule.Modele'
    };
</script>

@section Scripts {
    <script src="~/js/details.js"></script>
}